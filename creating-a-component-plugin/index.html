<!doctype html><html class="" lang=""><head>
  <meta charset="UTF-8">
  <!-- generator meta tag -->
  <!-- leave this for stats and Silex version check -->
  <meta name="generator" content="Silex v2.2.12">
  <!-- End of generator meta tag -->
  <script type="text/javascript" src="https://www.silexlabs.org/js/jquery.js"></script>
  
  
  <script type="text/javascript" src="https://www.silexlabs.org/js/front-end.js"></script>
  <link rel="stylesheet" href="https://www.silexlabs.org/css/normalize.css">
  <link rel="stylesheet" href="https://www.silexlabs.org/css/front-end.css">

  
  <script type="text/javascript" class="silex-script"></script>
  
  <title>Creating a component plugin</title>
  


<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet" class="silex-custom-font"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="description" content="Site silexlabs.org en Jekyll+Silex+Stastic"><meta name="twitter:description" content="Site silexlabs.org en Jekyll+Silex+Stastic"><meta name="og:description" content="Site silexlabs.org en Jekyll+Silex+Stastic"><meta name="twitter:title" content="Creating a component plugin"><meta name="og:title" content="Creating a component plugin"><meta name="twitter:site" content="@silexlabs"><link href="https://www.silexlabs.org/css/favicon.png" rel="shortcut icon"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://silexlabs.org/assets/silexlabs-wwx.jpg"><meta name="og:image" content="https://silexlabs.org/assets/silexlabs-wwx.jpg"><script src="https://www.silexlabs.org/js/script.js" type="text/javascript"></script><link href="https://www.silexlabs.org/css/styles.css" rel="stylesheet" type="text/css"><style>body { opacity: 0; transition: .25s opacity ease; }</style></head>

<body class="body-initial all-style enable-mobile prevent-resizable prevent-selectable editable-style silex-runtime silex-published" data-silex-type="container-element" style="" data-current-page="page-post">
  




























<section data-silex-type="container-element" class="prevent-resizable container-element editable-style silex-id-1563543778332-2 section-element"><div data-silex-type="container-element" class="editable-style silex-id-1563543778136-1 container-element silex-element-content website-width" style=""></div></section><section data-silex-type="container-element" class="container-element editable-style silex-id-1478366444112-1 section-element prevent-resizable" style="">
      <div data-silex-type="container-element" class="editable-style silex-element-content silex-id-1478366444112-0 container-element website-width" style=""><a href="https://www.silexlabs.org/" data-silex-type="image-element" class="editable-style silex-id-1563543746145-0 image-element" style=""><img src="https://www.silexlabs.org/assets/silexlabs.org_.2015.png" class=""></a><div data-silex-type="text-element" class="editable-style silex-id-1564083497965-0 text-element silex-component style-nav" style=""><div class="silex-element-content normal">

  <ul>

  <li>
    
    <a class="" href="https://www.silexlabs.org/">Accueil</a>
  </li>

  <li>
    
    <a class="" href="https://www.silexlabs.org/events">Evènements</a>
  </li>

  <li>
    
    <a class="" href="https://www.silexlabs.org/silexlabs">A propos</a>
  </li>

</ul>


</div></div><div data-silex-type="html-element" class="editable-style silex-id-1564093276656-2 html-element" style=""><div class="silex-element-content"><!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-N48MBGD" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) --></div></div></div>
  </section><section data-silex-type="container-element" class="prevent-resizable container-element editable-style silex-id-1563544245802-4 section-element hide-on-mobile page-index paged-element page-page page-posts page-post page-404 paged-element-visible"><div data-silex-type="container-element" class="editable-style silex-id-1563544245599-3 container-element silex-element-content website-width bg-shadow-top" style=""></div></section><section data-silex-type="container-element" class="container-element editable-style silex-id-1474394621033-3 section-element prevent-resizable page-page-posts page-page-post page-page-404 page-page paged-element page-posts page-post page-404 page-tags paged-element-visible" style="">
      <div data-silex-type="container-element" class="editable-style silex-element-content silex-id-1474394621032-2 container-element website-width bg-shadow" style=""><div data-silex-type="text-element" class="editable-style silex-id-1563563640945-15 text-element silex-component style-post page-page-postaaa page-page-post page-post paged-element page-page paged-element-visible" style=""><div class="silex-element-content normal">

  <article>
  <h1>Creating a component plugin</h1><div class="post-date">16 August 2011</div>
  <p><p>This article assumes that you know how to create a plugin in Silex, you can find all the infos</p>

<p>A component plugin is a plugin adding components that the admin user can add to the publication and edit in the wysiwyg. For instance the BaseComponents, oofComponents and silexComponents of the base distribution are all component plugins, as their goal is to add an array of components available in the wysiwyg. For instance if you create a gallery for Silex, developed in AS2, you will need to create a plugin component to easily make it available for the user in the wysiwyg.</p>

<h2 id="the-pluginlibrarycomponentbase-php-class">The PluginLibraryComponentBase PHP class</h2>

<p>Like any plugin, the component plugins must extends the plugin_base class to be activated by Silex. However the Silex distribution include tht PluginLibraryComponentBase, a class extending plugin_base, automating the process of creating a component plugin. You can for instance look into the index.php file of the baseComponents plugin. The BaseComponents class extends the PluginComponentLibraryBase and does’nt need to do anything else to work as a component library. It works by having PluginComponentLibraryBase look for all the required infos to add a component in the XML descriptors of each component. We won’t detail how the class works, you can find it  in your server in cgi/includes/PluginComponentLibraryBase.</p>

<h2 id="looking-at-the-image-descriptor">Looking at the Image descriptor</h2>

<p>We will use an exemple to illustrate how to add a component to the wysiwyg. You can find the Image XML descriptor in you silex server in the plugins/baseComponents/descriptors/Image.xml</p>

<h2 id="the-metadata-tag">The metaData tag</h2>

<p>All the added info required by the PluginComponentLibraryBase are contained in the metaData tag. We will look at each node we find in it.</p>

<p><code class="language-plaintext highlighter-rouge">`&lt;metaData&gt;`</code></p>

<p><code class="language-plaintext highlighter-rouge">&lt;pluginRelativeUrl&gt;plugins/baseComponents/&lt;/pluginRelativeUrl&gt;</code></p>

<p><code class="language-plaintext highlighter-rouge">&lt;addComponentParams&gt;</code></p>

<name>NewImage</name>

<uid>silex.AddComponent.ToolItem.AddImage</uid>

<groupUid>silex.AddComponent.ToolItemGroup.Images</groupUid>

<toolUid>silex.AddComponent.Tool</toolUid>

<p><label>LABEL_IMAGE</label></p>

<description>DESCRIPTION_IMAGE</description>

<level>0</level>

<action>addMediaComponent</action>

<initPropertyName>url</initPropertyName>

<iconUrl>icons/images.swf</iconUrl>

<p>&lt;/addComponentParams&gt;</p>

<p>&lt;/metaData&gt;</p>

<h3 id="pluginrelativeurl">PluginRelativeUrl</h3>

<p>Indicates the url of the plugin relative to the silex server. It is used for instance to locate the url of the icon located in the plugin to display in the component panel next to the component’s name. This info can be retrieved in As3 using the SilexAdminAPI</p>

<h3 id="addcomponentparams">addComponentParams</h3>

<dl>
  <dt>This tag contains all the info to add an item in the wysiwyg “addComponents” panel. It use the toolbar system of the Silex, if you’re not familiar with it, you can fid the infos here</dt>
  <dd>(TO DO).  The name tag is the name of the component that will appear in the component’s panel once added.</dd>
</dl>

<p>The uid is an unique identifier for the item in the “addComponent” panel.</p>

<p>The groupUid is used to place your component’ item in the right group in the “addComponent” panel. For instance we see here that the item is added in the “silex.AddComponent.ToolItemGroup.Images” group. If you want to add it to another group, you can either create your own group or use another existing one. You can find the uid of existing group either by looking into the descriptors of components belonging to the group you look or by looking into the index.php of the wysiwyg, which add most of the basic groups.</p>

<p>The toolUid is used to place the item in the right toolbar. For now only the “AddComponent” toolbar can be used as other toolbar such as the view menu are not compatible with the add component system but eventually other compatible toolbars might be created.</p>

<p>The label and description are displayed in the AddComponent panel next to the button and as tooltips.</p>

<p>The level is the place you want your item to appear in the group. If you level is 0, the plugin will appear at the beginning or near the begining, if it 10 or more it will most likely appear at the end. This system is necessary as we can’t now at first how many items will appear in a group, so the item can’t just choose a place but instead request a place.</p>

<p>The action tag determine what will happen when the user clicks on the button, there are three possible
values:</p>
<ul>
  <li>
    <dl>
      <dt>addComponent</dt>
      <dd>When the user clicks on the button, the component is instantly added to the selected subLayer.</dd>
    </dl>
  </li>
  <li>
    <dl>
      <dt>addMediaComponent</dt>
      <dd>When the user clicks on the button, the library is opened as the user needs to choose a media. When the user import is media, the component is added to the publication</dd>
    </dl>
  </li>
  <li>
    <dl>
      <dt>addSkinnableComponent</dt>
      <dd>When the user clicks on the button, a panel opens asking the user to choose a skin for the component. When the user chooses a skin, the component is added to the publication. It is used for component that can be skinned such as buttons or lists. For more info, read the “skinned component” paragraph below.</dd>
    </dl>
  </li>
</ul>

<p>For the initPropertyName, read the “media component” paragraph below.</p>

<p>iconUrl is the url of the icon displayed in the AddComponent panel and in the components panel.</p>

<h2 id="descriptors-location">Descriptors location</h2>

<p>For the PluginLibraryComponentBase to find the descriptors, they must be located in your plugin, in a folder called “descriptors”, like in the baseComponents or oofComponents plugins.</p>

<h2 id="the-three-components-type">The three components type</h2>

<p>There are three  types of component, each one corresponding to an action. The media and skinned component type add extra tags to the metaData of the component.</p>

<h3 id="component">Component</h3>

<p>The simpler type of component, used for component that does’nt need extra ste to add.For instance non-visual components like an XMLConnector, don’t need extra step as they are neither media nor skinned.</p>

<h3 id="media-component">Media Component</h3>

<dl>
  <dt>Media components are components that rely on a media such as a video, an image, an mp3. For instance in the baseComponents, you can find Image,Video and Audio which all work with different kinds of media. The media components require one extra tag</dt>
  <dd>the <initPropertyName> tag. It is the name of the property that needs to be initiliased with the component that is the media url. For instance, in the Image XML descriptor, we can see that the initPropertyName is "url". Here is the "url" property, found below in the descriptor</initPropertyName></dd>
  <dd>`<url></url></dd>
</dl>
<type>String</type>
<subType>Url</subType>
<description>PROPERTIES_LABEL_URL</description>
<defaultValue>defaultUrl</defaultValue>
<isRegistered>true</isRegistered>
<extensions>jpg,jpeg,gif,png,swf</extensions>
<group>attributes</group>
<p>&lt;/url&gt;`</p>

<p>When the user clicks on the component button in the addComponent toolbox, this property will be used to open the library and set it’s authorised extensions with the value of <extensions> tag. When the user selects a media in the opened library, an instance of the component is created and it's <initPropertyName> property is initialised with the url of the media chosen by the user. The subType "Url" will also insure that when the user wants to swap the media of the component, the library opens with the right authorised extensions.</initPropertyName></extensions></p>

<h3 id="skinned-component">Skinned Component</h3>

<p>Skinned component are components that can have multiple different design. For instance a button or a list is a skinnable component, a designer can create a new appearance for the plugin without altering it’s behaviour. You can add any number of skin to a component, by adding a <skins> tag in the metaData of the drescriptor. Let's look at the RichTextList descriptor found in plugins/oofComponents/descriptors/RichTextList.xml.</skins></p>

<dl>
  <dt>In it we can see the following tag</dt>
  <dd>`</dd>
</dl>
<skins>  
<skin>  
<label>RichTextList skin 1</label>  
<url>as2/RichTextList/RichTextList1.swf</url>  
<description>skin1 description</description>  
</skin>  
</skins>
<p>`<br />
This tag add one skin, define it’s label, url and description. You can add as many<skin> tag as you have skins. If a designer create skins that are not included in the plugin, he can add them by first clicking on the component button, then clicking the "+" button next to the skins list that will open the library, allowing the user to browse to it's skinned component.</skin></p>

<h2 id="adding-groups">Adding groups</h2>

<dl>
  <dt>If you need to create one or many groups in the addComponent toolbox, specifically for your plugin, you can override the “addToolBar” PHP method of the PluginComponentLibraryBase class. This method returns a string that contain the JavaScript required to add one or many groups. By default it returns nothing. Here is an exemple of how to add a group called TestGroup</dt>
  <dd><code class="language-plaintext highlighter-rouge">  
protected function addToolBarGroups(){</code></dd>
</dl>

<p><code class="language-plaintext highlighter-rouge">$ret = 'silexNS.SilexAdminApi.callApiFunction('toolBarGroups', 'addItem', [{';  
$ret.= 'name:'TestGroup',';  
$ret.= 'uid:'silex.AddComponent.ToolItemGroup.TestGroup',';  
$ret.= 'level:0,';  
$ret.= 'toolUid:'silex.AddComponent.Tool',';  
$ret.= 'label:'This is the TestGroup label',';  
$ret.= 'description:'This is the TestGroup description'}]);';</code></p>

<p><code class="language-plaintext highlighter-rouge">return $ret;  
}  
</code><br />
You can then add component to the new group by modifing the <groupUid> tag in the component XML descriptor</groupUid></p>
</p>
  
</article>


</div></div><div data-silex-type="container-element" class="editable-style container-element silex-id-1595517439711-1" style=""><a href="https://www.silexlabs.org/join" data-silex-type="text-element" class="editable-style silex-id-1563544847465-8 text-element style-button-green" style="width: 300px; min-height: 41px;"><div class="silex-element-content normal">Rejoignez nous<br></div></a><div data-silex-type="html-element" class="editable-style silex-id-1563544962714-9 html-element silex-component" style=""><div class="silex-element-content">
<ul class="share-buttons" id="id_1624149636224_143">
  
  <li><a href="https://www.facebook.com/sharer/sharer.php?u=https://www.silexlabs.org/&amp;t=Silex Labs non profit organization" title="Share on Facebook" target="_blank"><img alt="Share on Facebook" src="https://www.silexlabs.org/assets/Facebook.png"></a></li>
  
  
  <li><a href="https://twitter.com/intent/tweet?source=https://www.silexlabs.org/&amp;text=Silex Labs non profit organization:%20https://www.silexlabs.org/&amp;via=silexlabs" target="_blank" title="Share on Twitter"><img alt="Twitt" src="https://www.silexlabs.org/assets/Twitter.png"></a></li>
  
  
  
  
  
  
  
  <li><a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.silexlabs.org/&amp;title=Silex Labs non profit organization&amp;summary=Silex Labs est une association à but non lucratif reconnue d’intérêt général qui lutte depuis 2009 contre la fracture numérique, en faisant promotion des technologies libres et de la contribution.

Notre conviction : la contribution change la vie de celui qui contribue et améliore celle des autres.&amp;source=https://www.silexlabs.org/" target="_blank" title="Share on LinkedIn"><img alt="Share on LinkedIn" src="https://www.silexlabs.org/assets/LinkedIn.png"></a></li>
  
  
  
  
  <li><a href="mailto:?subject=Silex Labs non profit organization&amp;body=Silex Labs est une association à but non lucratif reconnue d’intérêt général qui lutte depuis 2009 contre la fracture numérique, en faisant promotion des technologies libres et de la contribution.

Notre conviction : la contribution change la vie de celui qui contribue et améliore celle des autres.:%20https://www.silexlabs.org/" target="_blank" title="Send email"><img alt="Send by email" src="https://www.silexlabs.org/assets/Email.png"></a></li>
  
</ul>

<style type="text/css">#id_1624149636224_143.share-buttons {list-style: none; padding: 0;}#id_1624149636224_143.share-buttons li {display: inline;}#id_1624149636224_143.share-buttons .sr-only {position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0; border: 0; height: 1px; width: 1px; overflow: hidden;}</style>
</div></div><div data-silex-type="html-element" class="editable-style silex-id-1563554584898-11 html-element hide-on-mobile bg-shadow" style=""><div class="silex-element-content">

<div id="fb-root"></div>
<script async="" defer="" crossorigin="anonymous" src="https://connect.facebook.net/fr_FR/sdk.js#xfbml=1&amp;version=v7.0&amp;appId=242623139095821" nonce="0Dnd4VdO" type="text/javascript"></script>

<div class="fb-page" data-href="https://www.facebook.com/silexlabs/" data-tabs="timeline" data-width="" data-height="" data-small-header="false" data-adapt-container-width="true" data-hide-cover="false" data-show-facepile="true">
</div></div></div><div data-silex-type="html-element" class="editable-style silex-id-1564088083884-1 html-element hide-on-mobile max-height bg-shadow" style=""><div class="silex-element-content">


<a class="twitter-timeline" href="https://twitter.com/silexlabs?ref_src=twsrc%5Etfw"></a>
<script type="text/javascript" async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</div></div></div></div>
  </section><section data-silex-type="container-element" class="container-element editable-style silex-id-1478366450713-3 section-element prevent-resizable" style="">
      <div data-silex-type="container-element" class="editable-style silex-element-content silex-id-1478366450713-2 container-element website-width bg-shadow" style="">

          <div class="editable-style silex-id-1442914737143-3 text-element style-footer" data-silex-type="text-element" style="">
              <div class="silex-element-content normal"><p><a href="https://www.silex.me/">Powered by Silex</a>, <a href="https://stastic.net/">Stastic</a> <a href="https://jekyllrb.com/">and Jekyll</a><a href="https://pages.github.com/">, </a>hosted on Github pages<a href="https://jekyllrb.com/"><br></a></p><p><a href="https://jekyllrb.com/"></a></p></div>
          </div>
      </div>
  </section><section data-silex-type="container-element" class="prevent-resizable container-element editable-style silex-id-1563544667829-6 section-element"><div data-silex-type="container-element" class="editable-style silex-id-1563544667707-5 container-element silex-element-content website-width"></div></section></body></html>