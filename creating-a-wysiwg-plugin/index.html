<!doctype html><html class="" lang=""><head>
  <meta charset="UTF-8">
  <!-- generator meta tag -->
  <!-- leave this for stats and Silex version check -->
  <meta name="generator" content="Silex v2.2.12">
  <!-- End of generator meta tag -->
  <script type="text/javascript" src="https://www.silexlabs.org/js/jquery.js"></script>
  
  
  <script type="text/javascript" src="https://www.silexlabs.org/js/front-end.js"></script>
  <link rel="stylesheet" href="https://www.silexlabs.org/css/normalize.css">
  <link rel="stylesheet" href="https://www.silexlabs.org/css/front-end.css">

  
  <script type="text/javascript" class="silex-script"></script>
  
  <title>Creating a Wysiwyg plugin</title>
  


<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet" class="silex-custom-font"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="description" content="Site silexlabs.org en Jekyll+Silex+Stastic"><meta name="twitter:description" content="Site silexlabs.org en Jekyll+Silex+Stastic"><meta name="og:description" content="Site silexlabs.org en Jekyll+Silex+Stastic"><meta name="twitter:title" content="Creating a Wysiwyg plugin"><meta name="og:title" content="Creating a Wysiwyg plugin"><meta name="twitter:site" content="@silexlabs"><link href="https://www.silexlabs.org/css/favicon.png" rel="shortcut icon"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://silexlabs.org/assets/silexlabs-wwx.jpg"><meta name="og:image" content="https://silexlabs.org/assets/silexlabs-wwx.jpg"><script src="https://www.silexlabs.org/js/script.js" type="text/javascript"></script><link href="https://www.silexlabs.org/css/styles.css" rel="stylesheet" type="text/css"><style>body { opacity: 0; transition: .25s opacity ease; }</style></head>

<body class="body-initial all-style enable-mobile prevent-resizable prevent-selectable editable-style silex-runtime silex-published" data-silex-type="container-element" style="" data-current-page="page-post">
  




























<section data-silex-type="container-element" class="prevent-resizable container-element editable-style silex-id-1563543778332-2 section-element"><div data-silex-type="container-element" class="editable-style silex-id-1563543778136-1 container-element silex-element-content website-width" style=""></div></section><section data-silex-type="container-element" class="container-element editable-style silex-id-1478366444112-1 section-element prevent-resizable" style="">
      <div data-silex-type="container-element" class="editable-style silex-element-content silex-id-1478366444112-0 container-element website-width" style=""><a href="https://www.silexlabs.org/" data-silex-type="image-element" class="editable-style silex-id-1563543746145-0 image-element" style=""><img src="https://www.silexlabs.org/assets/silexlabs.org_.2015.png" class=""></a><div data-silex-type="text-element" class="editable-style silex-id-1564083497965-0 text-element silex-component style-nav" style=""><div class="silex-element-content normal">

  <ul>

  <li>
    
    <a class="" href="https://www.silexlabs.org/">Accueil</a>
  </li>

  <li>
    
    <a class="" href="https://www.silexlabs.org/events">Evènements</a>
  </li>

  <li>
    
    <a class="" href="https://www.silexlabs.org/silexlabs">A propos</a>
  </li>

</ul>


</div></div><div data-silex-type="html-element" class="editable-style silex-id-1564093276656-2 html-element" style=""><div class="silex-element-content"><!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-N48MBGD" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) --></div></div></div>
  </section><section data-silex-type="container-element" class="prevent-resizable container-element editable-style silex-id-1563544245802-4 section-element hide-on-mobile page-index paged-element page-page page-posts page-post page-404 paged-element-visible"><div data-silex-type="container-element" class="editable-style silex-id-1563544245599-3 container-element silex-element-content website-width bg-shadow-top" style=""></div></section><section data-silex-type="container-element" class="container-element editable-style silex-id-1474394621033-3 section-element prevent-resizable page-page-posts page-page-post page-page-404 page-page paged-element page-posts page-post page-404 page-tags paged-element-visible" style="">
      <div data-silex-type="container-element" class="editable-style silex-element-content silex-id-1474394621032-2 container-element website-width bg-shadow" style=""><div data-silex-type="text-element" class="editable-style silex-id-1563563640945-15 text-element silex-component style-post page-page-postaaa page-page-post page-post paged-element page-page paged-element-visible" style=""><div class="silex-element-content normal">

  <article>
  <h1>Creating a Wysiwyg plugin</h1><div class="post-date">16 August 2011</div>
  <p><p>In this section, we will create a silex plugin that will display a “hello silex !” text in the properties panel of the wysiwyg.</p>

<p>The plugin will be based on an index.php file initialising the plugin, on a Flex application that will be displayed in the Wysiwyg, and on a button, visible in the properties toolbox header and displaying our plugin.</p>

<p>This document implies a knowledge of object-oriented PHP5, ActionScript3/Flex and Javascript. It also implies that you know how to create a Silex plugin and how to use the Silex Toolbar system (i.e. ViewMenu).</p>

<h2 id="i-creating-the-plugin-index">I/ Creating the plugin Index</h2>

<p>Creating a Silex plugin is out of the scope of this document. You can find all the necessary information <a href="http://community.silexlabs.org/silex/codex/?page_id=10">here</a>.</p>

<p>As we will create a new Silex plugin, it needs to have it’s own folder in the “plugins” directory. In the “plugins” folder of your silex server, create a new folder called “helloWysiwygPlugin” and create the index.php class. You should have the following
structure: silex_trunksilex_serverpluginshelloWysiwygPlugin</p>

<h2 id="ii-creating-the-flex-application">II/ Creating the Flex application</h2>

<p>We will now create a simple Flex application, and display the resulting SWF in the Wysiwyg properties toolbox. You can also use pure AS3 SWF, but Flex framework is often more convenient to build interfaces as you can use all the skinned controls of the wysiwyg.</p>

<p>In Flex or FlashDevelop, create a new project and set the build path to the “helloWysiwygPlugin” folder of your Silex Server, using “helloWysiwygPlugin.swf” as the name of the output file. The project will only be constituted of a main Application class as you can see in the following
code: 
<?xml version="1.0" encoding="utf-8"?></p>

<mx:Text text="Hello Wysiwyg plugin !" />

<p>&lt;/mx:Application&gt;</p>

<p>Once loaded in the Wysiwyg, the application will display a text “Hello Wysiwyg plugin !”.</p>

<h2 id="iii-adding-the-plugins-opening-button-to-the-properties-toolbox-toolbar">III/ Adding the plugin’s opening button to the properties toolbox toolbar</h2>

<p>The next step is to add a button in the properties toolbox header that will, when clicked, display the “helloWysiwygPlugin” plugin in the properties toolbox body.</p>

<p>At first we need to create the button as a separate SWF file and then add this button to the toolbar using the SilexAdminAPI in JavaScript.</p>

<h3 id="a-creating-the-button">a/ Creating the button</h3>

<p>The button will be an independant Flash project with it’s own logic. It will be include a FLA file (button design) and an ActionScript3 class. We will use Flash IDE as it is the simplest way to create graphical assets but you can also create the button with code only (by using FlashDevelop for instance).</p>

<h3 id="b-creating-the-graphical-asset">b/ Creating the graphical asset</h3>

<ul>
  <li>Create a new folder such as silex_trunkprojectstoolshelloWysiwygPlugin</li>
  <li>Open Flash IDE and create a new ActionScript3 project in it.</li>
  <li>Set the size of the Stage to 20x20</li>
  <li>Create a new Button in the library and design it. This asset will be the one displayed in the properties toolbox header.</li>
  <li>Put one instance of the item on the stage and name its intance “button”.</li>
  <li>Set the document class to “HelloWysiwygPluginButton”, this is the name of the class that will control the button logic. This class has to be created and saved in the same folder.</li>
  <li>Set the publication path of the FLA to the “helloWysiwygPlugin” folder of your Silex Server (silex_trunksilex_serverpluginshelloWysiwygPlugin) and set the output file to “helloWysiwygPluginButton.swf”.</li>
  <li>
    <dl>
      <dt>In the FLA, add the following source folder</dt>
      <dd>silex_trunkprojectstoolswysiwigToolBoxAPIsrc. We will use these packages to communicate with the wysiwyg.</dd>
    </dl>
  </li>
  <li>Save the FLA</li>
</ul>

<h3 id="c-creating-the-button-class">c/ Creating the button class</h3>

<p>Create an ActionScript class file and call it “HelloWysiwygPluginButton.as”. Save it in the folder where you saved your FLA.</p>

<dl>
  <dt>You can use the following code for your class</dt>
  <dd><code class="language-plaintext highlighter-rouge">package  {  
import flash.display.Sprite;  
import flash.events.MouseEvent;  
import flash.display.SimpleButton;  
import org.silex.wysiwyg.toolboxApi.ToolBoxAPIController;</code></dd>
</dl>

<p>public class HelloWysiwygPluginButton extends Sprite {</p>

<p>/**</p>
<ul>
  <li>This is a reference to the button that you put on the stage of your FLA<br />
*/<br />
public var button:SimpleButton;</li>
</ul>

<p>/**</p>
<ul>
  <li>This is the url of the Flex Application that we want to load in the wysiwyg</li>
  <li>It is the relative path starting from the server root<br />
*/<br />
private static const pluginUrl:String = “plugins/helloWysiwygPlugin/helloWysiwygPlugin.swf”;</li>
</ul>

<p>/**</p>
<ul>
  <li>We add a listener to the click of the button<br />
*/<br />
public function HelloWysiwygPluginButton()<br />
{<br />
button.addEventListener(MouseEvent.MOUSE_DOWN, mouseDownHandler);<br />
}</li>
</ul>

<p>/**</p>
<ul>
  <li>When the user clicks the button, we get an instance of the ToolBoxApiController and ask it</li>
  <li>to load our Flex application in the properties toolbox<br />
*/</li>
</ul>

<p>{<br />
ToolBoxAPIController.getInstance().loadEditor(pluginUrl, “Hello Wysiwyg plugin description”);<br />
}<br />
}</p>

<p>}</p>

<p>Publish the FLA to SWF.</p>

<h3 id="d-the-toolboxapi">d/ the ToolBoxAPI</h3>

<dl>
  <dt>In HelloWysiwygPluginButton class, we use the ToolBoxAPI project to communicate with the Wysiwyg. This project is an API exposing method controlling some of the key behaviour of the Wysiwyg. It is mainly used by plugins to load their editor in the Wysiwyg properties ToolBox. To do se, they use the ToolBoxAPIController class. It is a singleton that exposes methods to load editors and get info on the loaded editor. It exposes the following method</dt>
  <dd></dd>
</dl>

<p>This method loads the requested editorUrl, and also  displays the description of the editor in the Wysiwyg. This method dispatches a ToolBoxAPIEvent.LOAD_EDITOR event that can be used to keep track of the loaded editor. For instance, you can use it to toggle the plugin’s editor button and disable it when the corresponding editor is loaded.</p>

<p>This method sets the requested editor as the default editor but does not load it. The corresponding editor will be only loaded when the wysiwyg closes and re-opens the properties panel. Any plugin can become the default plugin. Tthe Specific Plugin is the default.</p>

<p><code class="language-plaintext highlighter-rouge">getDefaultEditor():Object</code></p>

<p>Returns an object containing the defaultEditor Url and description.</p>

<h3 id="e-adding-the-button-to-the-properties-toolbox-toolbar">e/ adding the button to the properties toolbox toolbar</h3>

<p>Once the SWF button is generated, the javaScript SilexAdminAPI has to be used to add it to the Wysiwyg properties toolbox toolbar. You can find a more detailed information on how to use and create toolbars here. (LINK TO TOOLBAR PAGE)</p>

<dl>
  <dt>In the Index.php class of your plugin, add a callback to the “admin-body-end” PHP hook. Add the following script in the callback</dt>
  <dd>silexNS.SilexAdminApi.callApiFunction(“toolBarItems”, “addItem”,<br />
[{name:”HelloWysiwygPluginButton”,<br />
hasBackground:false,<br />
uid:”silex.Properties.ToolItem.HelloWysiwygPluginButton”,<br />
groupUid:”silex.Properties.ToolItemGroup.Display”,</dd>
</dl>

<p>label:”the HelloWysiwygPlugin label”,<br />
description:” the HelloWysiwygPlugin description”,<br />
url:$rootUrl+”plugins/helloWysiwygPlugin/helloWysiwygPluginButton.swf”}]);</p>

<p>This script calls the “addItem” method on SilexAdminAPI’s ”toolbarItems” which adds the SWF to the properties toolbar. This method’s parameters are used to define to which toolbar and group our new item has to be added, but aso the item’s informations (name, description, level in the group…) and finally the SWF button’s url.</p>

<h3 id="f-testing">f/ testing</h3>

<p>You first need to activate the plugin in the manager.</p>

<p>Then launch your website and login to see the Viewmenu.</p>

<p>When the wysiwyg properties toolbox is opened, you can now see that the new button appears, and that when clicked, it loads the Flex application displaying the “Hello Wysiwyg plugin !” text.</p>
</p>
  
</article>


</div></div><div data-silex-type="container-element" class="editable-style container-element silex-id-1595517439711-1" style=""><a href="https://www.silexlabs.org/join" data-silex-type="text-element" class="editable-style silex-id-1563544847465-8 text-element style-button-green" style="width: 300px; min-height: 41px;"><div class="silex-element-content normal">Rejoignez nous<br></div></a><div data-silex-type="html-element" class="editable-style silex-id-1563544962714-9 html-element silex-component" style=""><div class="silex-element-content">
<ul class="share-buttons" id="id_1624149636224_143">
  
  <li><a href="https://www.facebook.com/sharer/sharer.php?u=https://www.silexlabs.org/&amp;t=Silex Labs non profit organization" title="Share on Facebook" target="_blank"><img alt="Share on Facebook" src="https://www.silexlabs.org/assets/Facebook.png"></a></li>
  
  
  <li><a href="https://twitter.com/intent/tweet?source=https://www.silexlabs.org/&amp;text=Silex Labs non profit organization:%20https://www.silexlabs.org/&amp;via=silexlabs" target="_blank" title="Share on Twitter"><img alt="Twitt" src="https://www.silexlabs.org/assets/Twitter.png"></a></li>
  
  
  
  
  
  
  
  <li><a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.silexlabs.org/&amp;title=Silex Labs non profit organization&amp;summary=Silex Labs est une association à but non lucratif reconnue d’intérêt général qui lutte depuis 2009 contre la fracture numérique, en faisant promotion des technologies libres et de la contribution.

Notre conviction : la contribution change la vie de celui qui contribue et améliore celle des autres.&amp;source=https://www.silexlabs.org/" target="_blank" title="Share on LinkedIn"><img alt="Share on LinkedIn" src="https://www.silexlabs.org/assets/LinkedIn.png"></a></li>
  
  
  
  
  <li><a href="mailto:?subject=Silex Labs non profit organization&amp;body=Silex Labs est une association à but non lucratif reconnue d’intérêt général qui lutte depuis 2009 contre la fracture numérique, en faisant promotion des technologies libres et de la contribution.

Notre conviction : la contribution change la vie de celui qui contribue et améliore celle des autres.:%20https://www.silexlabs.org/" target="_blank" title="Send email"><img alt="Send by email" src="https://www.silexlabs.org/assets/Email.png"></a></li>
  
</ul>

<style type="text/css">#id_1624149636224_143.share-buttons {list-style: none; padding: 0;}#id_1624149636224_143.share-buttons li {display: inline;}#id_1624149636224_143.share-buttons .sr-only {position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0; border: 0; height: 1px; width: 1px; overflow: hidden;}</style>
</div></div><div data-silex-type="html-element" class="editable-style silex-id-1563554584898-11 html-element hide-on-mobile bg-shadow" style=""><div class="silex-element-content">

<div id="fb-root"></div>
<script async="" defer="" crossorigin="anonymous" src="https://connect.facebook.net/fr_FR/sdk.js#xfbml=1&amp;version=v7.0&amp;appId=242623139095821" nonce="0Dnd4VdO" type="text/javascript"></script>

<div class="fb-page" data-href="https://www.facebook.com/silexlabs/" data-tabs="timeline" data-width="" data-height="" data-small-header="false" data-adapt-container-width="true" data-hide-cover="false" data-show-facepile="true">
</div></div></div><div data-silex-type="html-element" class="editable-style silex-id-1564088083884-1 html-element hide-on-mobile max-height bg-shadow" style=""><div class="silex-element-content">


<a class="twitter-timeline" href="https://twitter.com/silexlabs?ref_src=twsrc%5Etfw"></a>
<script type="text/javascript" async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</div></div></div></div>
  </section><section data-silex-type="container-element" class="container-element editable-style silex-id-1478366450713-3 section-element prevent-resizable" style="">
      <div data-silex-type="container-element" class="editable-style silex-element-content silex-id-1478366450713-2 container-element website-width bg-shadow" style="">

          <div class="editable-style silex-id-1442914737143-3 text-element style-footer" data-silex-type="text-element" style="">
              <div class="silex-element-content normal"><p><a href="https://www.silex.me/">Powered by Silex</a>, <a href="https://stastic.net/">Stastic</a> <a href="https://jekyllrb.com/">and Jekyll</a><a href="https://pages.github.com/">, </a>hosted on Github pages<a href="https://jekyllrb.com/"><br></a></p><p><a href="https://jekyllrb.com/"></a></p></div>
          </div>
      </div>
  </section><section data-silex-type="container-element" class="prevent-resizable container-element editable-style silex-id-1563544667829-6 section-element"><div data-silex-type="container-element" class="editable-style silex-id-1563544667707-5 container-element silex-element-content website-width"></div></section></body></html>