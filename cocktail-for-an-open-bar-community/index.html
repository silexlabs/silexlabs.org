<!doctype html><html class="" lang=""><head>
  <meta charset="UTF-8">
  <!-- generator meta tag -->
  <!-- leave this for stats and Silex version check -->
  <meta name="generator" content="Silex v2.2.12">
  <!-- End of generator meta tag -->
  <script type="text/javascript" src="https://www.silexlabs.org/js/jquery.js"></script>
  
  
  <script type="text/javascript" src="https://www.silexlabs.org/js/front-end.js"></script>
  <link rel="stylesheet" href="https://www.silexlabs.org/css/normalize.css">
  <link rel="stylesheet" href="https://www.silexlabs.org/css/front-end.css">

  
  <script type="text/javascript" class="silex-script"></script>
  
  <title>Cocktail, for an open bar community !</title>
  


<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet" class="silex-custom-font"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="description" content="Site silexlabs.org en Jekyll+Silex+Stastic"><meta name="twitter:description" content="Site silexlabs.org en Jekyll+Silex+Stastic"><meta name="og:description" content="Site silexlabs.org en Jekyll+Silex+Stastic"><meta name="twitter:title" content="Cocktail, for an open bar community !"><meta name="og:title" content="Cocktail, for an open bar community !"><meta name="twitter:site" content="@silexlabs"><link href="https://www.silexlabs.org/css/favicon.png" rel="shortcut icon"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://silexlabs.org/assets/silexlabs-wwx.jpg"><meta name="og:image" content="https://silexlabs.org/assets/silexlabs-wwx.jpg"><script src="https://www.silexlabs.org/js/script.js" type="text/javascript"></script><link href="https://www.silexlabs.org/css/styles.css" rel="stylesheet" type="text/css"><style>body { opacity: 0; transition: .25s opacity ease; }</style></head>

<body class="body-initial all-style enable-mobile prevent-resizable prevent-selectable editable-style silex-runtime silex-published" data-silex-type="container-element" style="" data-current-page="page-post">
  




























<section data-silex-type="container-element" class="prevent-resizable container-element editable-style silex-id-1563543778332-2 section-element"><div data-silex-type="container-element" class="editable-style silex-id-1563543778136-1 container-element silex-element-content website-width" style=""></div></section><section data-silex-type="container-element" class="container-element editable-style silex-id-1478366444112-1 section-element prevent-resizable" style="">
      <div data-silex-type="container-element" class="editable-style silex-element-content silex-id-1478366444112-0 container-element website-width" style=""><a href="https://www.silexlabs.org/" data-silex-type="image-element" class="editable-style silex-id-1563543746145-0 image-element" style=""><img src="https://www.silexlabs.org/assets/silexlabs.org_.2015.png" class=""></a><div data-silex-type="text-element" class="editable-style silex-id-1564083497965-0 text-element silex-component style-nav" style=""><div class="silex-element-content normal">

  <ul>

  <li>
    
    <a class="" href="https://www.silexlabs.org/">Accueil</a>
  </li>

  <li>
    
    <a class="" href="https://www.silexlabs.org/events">Evènements</a>
  </li>

  <li>
    
    <a class="" href="https://www.silexlabs.org/silexlabs">A propos</a>
  </li>

</ul>


</div></div><div data-silex-type="html-element" class="editable-style silex-id-1564093276656-2 html-element" style=""><div class="silex-element-content"><!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-N48MBGD" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) --></div></div></div>
  </section><section data-silex-type="container-element" class="prevent-resizable container-element editable-style silex-id-1563544245802-4 section-element hide-on-mobile page-index paged-element page-page page-posts page-post page-404 paged-element-visible"><div data-silex-type="container-element" class="editable-style silex-id-1563544245599-3 container-element silex-element-content website-width bg-shadow-top" style=""></div></section><section data-silex-type="container-element" class="container-element editable-style silex-id-1474394621033-3 section-element prevent-resizable page-page-posts page-page-post page-page-404 page-page paged-element page-posts page-post page-404 page-tags paged-element-visible" style="">
      <div data-silex-type="container-element" class="editable-style silex-element-content silex-id-1474394621032-2 container-element website-width bg-shadow" style=""><div data-silex-type="text-element" class="editable-style silex-id-1563563640945-15 text-element silex-component style-post page-page-postaaa page-page-post page-post paged-element page-page paged-element-visible" style=""><div class="silex-element-content normal">

  <article>
  <h1>Cocktail, for an open bar community !</h1><div class="post-date">07 September 2011</div>
  <p><p><em><strong>Some parts of this article are now obsolete, as Cocktail has changed a lot (2012-08-14).</strong></em></p>

<p>Cocktail, what is cocktail?!</p>

<p><a href="https://www.silexlabs.org/groups/labs/cocktail/" title="Cocktail, cross-platform haXe">Cocktail is the name of a new project @ Silex Labs.</a></p>

<p><em>This is an article for developers about the haXe library Cocktail, cross platform haXe!</em></p>

<p><em>Please use up-to-date Firefox 6, Chrome or Safari, as there are still issues with other browsers.</em></p>

<p><img src="/assets/cocktail-image.jpg" alt="" title="cocktail-image" /></p>

<p>targets: <strong>HTML5 + javaScript, </strong>Flash, PHP**.</p>

<p>It helps <strong>multi device application development</strong> and should be used by haXe projects requiring cross-target compilation.</p>

<p>And of course, it is released under GPL.</p>

<p>In this alpha1 release, DOM manipulation basis are present, with assets loading, external libraries and native code includes, as well as drawing API. The text can be used, but the text style is not handled yet, so it may be different in js and Flash, as you can see it bellow.</p>

<p>Javascript and Flash version of the clock, try to guess which one is which :)</p>

<p>For now, the text styles are not handled yet, so it may appear different in js and Flash</p>

<p>In this article, we will see some demo of cross platform code, and focus on the Cocktail part of the sample code. The first example, the “clock” is very simple, we load png images and manipulate them to display the time it is. The “ski game” sample is a bit more complex, and uses a classic technique in games, where the game is drawn on a screen at each frame - the scree is a canvas in HTML, and a Sprite in Flash, but this is transparent with Cocktail.</p>

<p>press the space bar to play</p>

<p>guess what, this is not Flash !</p>

<p>Feel free to check the get started with <a href="http://haxe.org/com/libs/cocktail">Cocktail article on the haXe wiki</a> for more technical information and getting started with haXe article for more details about haXe.</p>

<p>Links</p>

<ul>
  <li><a href="https://www.silexlabs.org/groups/labs/cocktail/">Project home</a></li>
  <li><a href="https://github.com/silexlabs/Cocktail/wiki/Road-map" title="road map and development status">Cocktail road map and development state</a></li>
  <li><a href="https://github.com/silexlabs/Cocktail">Cocktail source code</a></li>
  <li><a href="https://www.silexlabs.org/groups/labs/cocktail/forum/">Forums</a></li>
  <li><a href="http://haxe.org/com/libs/cocktail">Cocktail wiki on haXe.org</a></li>
</ul>

<hr />

<h2 id="clock-demo">Clock demo</h2>

<p>Here is a very basic demo, which displays an analog clock. The code is very simple and uses Cocktail library to load the background image and the clock hand image, and display it rotated, with its center as a register point.</p>

<h3 id="flash-version">Flash version</h3>

<p>Requires Flash Player 10.2.</p>

<h3 id="javascript-version">javascript version</h3>

<p>Requires HTML5.</p>

<h3 id="the-code">The code</h3>

<p>You can take look at the <a href="https://github.com/SilexLabsThirdParty/Cocktail-legacy/blob/master/demo/clock/Clock.hx" title="Cocktail demo, the clock example">code on github</a>, and you will see that there is <strong>NO conditional compilation at all</strong>, no #if js nor #if flash…</p>

<p>Here we will show the parts which use the Cocktail API.</p>

<h4 id="1st">1st</h4>
<p>contact: the imports show some of the classes exposed by Cocktail</p>

<p>[sourcecode language=”actionscript3”]<br />
import cocktail.resource.ResourceLoaderManager;<br />
import cocktail.nativeElement.NativeElementManager;<br />
import cocktail.domElement.ImageDOMElement;<br />
import cocktail.domElement.TextDOMElement;<br />
[/sourcecode]</p>

<p>These classes will let you manipulate the javascript or Flash DOM seamlessly, load assets and get keyboard events. As you will see it below…</p>

<h4 id="the-stage-for-the-game">The stage for the game</h4>

<p>The “stage” or the root graphical object of our game, will be the root clip in Flash and the body in HTML. Here is how it is
declared: 
[sourcecode language=”actionscript3”]<br />
/**</p>
<ul>
  <li>The root of the dom (stage in flash, body in html)<br />
*/<br />
private static var rootDOMElement:DOMElement;<br />
[/sourcecode]</li>
</ul>

<p>And
initialized: 
[sourcecode language=”actionscript3”]<br />
rootDOMElement = new DOMElement(NativeElementManager.getRoot());<br />
[/sourcecode]</p>

<p>You can notice that the root clip is returned by NativeElementManager::getRoot. Its type is NativeElement, and it is used to create a DOMElement, which is the base type for all graphical objects in Cocktail. So, this instruction, creates a DOMElement which will be used as the root container of our application, it will represent the root Sprite in the Flash version, and the body element in HTML.</p>

<h4 id="the-graphical-objects">The graphical objects</h4>

<p>Here are the variables used to store the graphical objects</p>

<p>[sourcecode language=”actionscript3”]<br />
/**</p>
<ul>
  <li>the background of the analogue clock<br />
*/<br />
private var _clockBackground:ImageDOMElement;</li>
</ul>

<p>/**</p>
<ul>
  <li>the foreground of the analogue clock<br />
*/<br />
private var _clockForeGround:ImageDOMElement;</li>
</ul>

<p>/**</p>
<ul>
  <li>the second needle of the clock<br />
*/<br />
private var _secondNeedle:ImageDOMElement;</li>
</ul>

<p>/**</p>
<ul>
  <li>the minute needle of the clock<br />
*/<br />
private var _minuteNeedle:ImageDOMElement;</li>
</ul>

<p>/**</p>
<ul>
  <li>the hour needle of the clock<br />
*/<br />
private var _hourNeedle:ImageDOMElement;</li>
</ul>

<p>/**</p>
<ul>
  <li>the numeric clock<br />
*/<br />
private var _clockDisplay:TextDOMElement;<br />
[/sourcecode]</li>
</ul>

<h4 id="manipulation-of-the-dom">Manipulation of the DOM</h4>

<p>Here is the code where the graphical assets are loaded…</p>

<p>[sourcecode language=”actionscript3”]<br />
ResourceLoaderManager.loadImage(“assets/second_needle.png”, onSecondNeedleLoaded, function(err){});<br />
ResourceLoaderManager.loadImage(“assets/hour_needle.png”, onHourNeedleLoaded, function(err){});<br />
ResourceLoaderManager.loadImage(“assets/minute_needle.png”, onMinuteNeedleLoaded, function(err){});<br />
ResourceLoaderManager.loadImage(“assets/clock_background.png”, onClockBackgroundLoaded, function(err){});<br />
ResourceLoaderManager.loadImage(“assets/clock_foreground.png”, onClockForegroundLoaded, function(err){});<br />
[/sourcecode]</p>

<p>… and then attached to the DOM</p>

<p>[sourcecode language=”actionscript3”]<br />
rootDOMElement.addChild(_clockBackground);<br />
rootDOMElement.addChild(_secondNeedle);<br />
rootDOMElement.addChild(_minuteNeedle);<br />
rootDOMElement.addChild(_hourNeedle);<br />
rootDOMElement.addChild(_clockForeGround);<br />
[/sourcecode]</p>

<p>The rotation of the images is set in order to reflect the time it is</p>

<p>[sourcecode language=”actionscript3”]<br />
_secondNeedle.rotation = Math.round(Date.now().getSeconds() * 6);<br />
_minuteNeedle.rotation = Math.round(Date.now().getMinutes() * 6);<br />
_hourNeedle.rotation = Math.round(Date.now().getHours() * (360/12));<br />
[/sourcecode]</p>

<p>You can notice how simple it is to rotate a DOMElement with setRotation, passing the angle as the 1st argument and the rotation center as a 2d argument.</p>

<h4 id="about-the-text">About the text</h4>

<p>The text in cocktail is also handled as a DOMElement. But in this alpha1 release, the text style is not handled yet, so it may not appear the same in js and Flash.</p>

<p>[sourcecode language=”actionscript3”]<br />
_clockDisplay = new TextDOMElement();<br />
rootDOMElement.addChild(_clockDisplay);<br />
…<br />
_clockDisplay.text = Date.now().toString();<br />
[/sourcecode]</p>

<h2 id="ski-demo">Ski demo</h2>

<p>This example is interesting since it shows how to draw in a DOMElement, and how to use the keyboard events.</p>

<h3 id="flash-version-1">Flash version</h3>

<p>Requires Flash Player 10.2. Exactly the same as the original version…</p>

<h3 id="javascript-version-1">javascript version</h3>

<p>Requires HTML5. Looks the same :)</p>

<h3 id="the-code-1">The code</h3>

<p>You can take look at the <a href="https://github.com/SilexLabsThirdParty/Cocktail-legacy/blob/master/demo/ski/Ski.hx" title="Cocktail demo, the ski game">code on github</a>, and you will see that there is <strong>NO conditional compilation at all</strong>, no #if js nor #if flash…</p>

<p>Here we will show the parts which use the Cocktail API.</p>

<h4 id="the-main-classes">The main classes</h4>

<p>[sourcecode language=”actionscript3”]<br />
import cocktail.resource.ResourceLoaderManager;<br />
import cocktail.nativeElement.NativeElementManager;<br />
import cocktail.domElement.ImageDOMElement;<br />
import cocktail.domElement.GraphicDOMElement;<br />
import cocktail.domElement.TextDOMElement;<br />
import cocktail.domElement.DOMElement;<br />
import cocktail.keyboard.KeyboardData;<br />
[/sourcecode]</p>

<p>These classes will let you manipulate the javascript or Flash DOM seamlessly, load assets and get keyboard events. As you will see it below…</p>

<h4 id="the-graphical-elements">The graphical Elements</h4>

<p>Here are the variables used to store the graphical objects.</p>

<p>[sourcecode language=”actionscript3”]<br />
var mArena:GraphicDOMElement;<br />
var mBits:ImageDOMElement;<br />
[/sourcecode]</p>

<p>Note the GraphicDOMElement, this is the one to which we will draw. And we will use the ImageDOMElement as a source, since it will contain this png
image: 
<a href="https://www.silexlabs.org/129346/the-blog/cocktail-for-an-open-bar-community/attachment/tiles/"><img src="/assets/tiles.png" alt="" title="tile for the sky game" /></a></p>

<p>And here is the code where the GraphicDOMElement is initialized, before we can draw into
it: 
[sourcecode language=”actionscript3”]<br />
//the abstract gaphic dom object is instantiated and<br />
//its dimensions are set. It will be used as a cross-platform<br />
//drawing surface<br />
mArena = new GraphicDOMElement();<br />
mArena.width = 640;<br />
mArena.height = 480;</p>

<p>//it is attached to the root dom object, the higher object<br />
//in the DOM tree<br />
rootDOMElement.addChild(mArena);<br />
[/sourcecode]</p>

<p>And here is the “magic”, how to draw in a DOMElement, which means draw in a canvas or in a Sprite depending on the
target: 
[sourcecode language=”actionscript3”]<br />
//use the drawImage method of the GraphicDOMElement<br />
//to copy pixels onto a surface<br />
mArena.drawImage(mBits, mPoint, mRect);<br />
[/sourcecode]</p>

<h2 id="credits">Credits</h2>

<p>Special Thanks</p>

<ul>
  <li>Yannick for the code</li>
  <li><a href="http://superwup.com/">Pol</a> for the design</li>
</ul>
</p>
  
  <section class="tags">
    <h2>Tags</h2>
		<ul>
      
        
        <li class="tag"><a href="https://www.silexlabs.org/tag/cocktail">cocktail</a></li>
      
        
        <li class="tag"><a href="https://www.silexlabs.org/tag/cross-platform">cross-platform</a></li>
      
        
        <li class="tag"><a href="https://www.silexlabs.org/tag/demo">demo</a></li>
      
        
        <li class="tag"><a href="https://www.silexlabs.org/tag/flash">flash</a></li>
      
        
        <li class="tag"><a href="https://www.silexlabs.org/tag/haxe">Haxe</a></li>
      
        
        <li class="tag"><a href="https://www.silexlabs.org/tag/html5">html5</a></li>
      
        
        <li class="tag"><a href="https://www.silexlabs.org/tag/javascript">javaScript</a></li>
      
        
        <li class="tag"><a href="https://www.silexlabs.org/tag/js">js</a></li>
      
        
        <li class="tag"><a href="https://www.silexlabs.org/tag/library">library</a></li>
      
        
        <li class="tag"><a href="https://www.silexlabs.org/tag/php">php</a></li>
      
    </ul>
  </section>
  
</article>


</div></div><div data-silex-type="container-element" class="editable-style container-element silex-id-1595517439711-1" style=""><a href="https://www.silexlabs.org/join" data-silex-type="text-element" class="editable-style silex-id-1563544847465-8 text-element style-button-green" style="width: 300px; min-height: 41px;"><div class="silex-element-content normal">Rejoignez nous<br></div></a><div data-silex-type="html-element" class="editable-style silex-id-1563544962714-9 html-element silex-component" style=""><div class="silex-element-content">
<ul class="share-buttons" id="id_1624149636224_143">
  
  <li><a href="https://www.facebook.com/sharer/sharer.php?u=https://www.silexlabs.org/&amp;t=Silex Labs non profit organization" title="Share on Facebook" target="_blank"><img alt="Share on Facebook" src="https://www.silexlabs.org/assets/Facebook.png"></a></li>
  
  
  <li><a href="https://twitter.com/intent/tweet?source=https://www.silexlabs.org/&amp;text=Silex Labs non profit organization:%20https://www.silexlabs.org/&amp;via=silexlabs" target="_blank" title="Share on Twitter"><img alt="Twitt" src="https://www.silexlabs.org/assets/Twitter.png"></a></li>
  
  
  
  
  
  
  
  <li><a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.silexlabs.org/&amp;title=Silex Labs non profit organization&amp;summary=Silex Labs est une association à but non lucratif reconnue d’intérêt général qui lutte depuis 2009 contre la fracture numérique, en faisant promotion des technologies libres et de la contribution.

Notre conviction : la contribution change la vie de celui qui contribue et améliore celle des autres.&amp;source=https://www.silexlabs.org/" target="_blank" title="Share on LinkedIn"><img alt="Share on LinkedIn" src="https://www.silexlabs.org/assets/LinkedIn.png"></a></li>
  
  
  
  
  <li><a href="mailto:?subject=Silex Labs non profit organization&amp;body=Silex Labs est une association à but non lucratif reconnue d’intérêt général qui lutte depuis 2009 contre la fracture numérique, en faisant promotion des technologies libres et de la contribution.

Notre conviction : la contribution change la vie de celui qui contribue et améliore celle des autres.:%20https://www.silexlabs.org/" target="_blank" title="Send email"><img alt="Send by email" src="https://www.silexlabs.org/assets/Email.png"></a></li>
  
</ul>

<style type="text/css">#id_1624149636224_143.share-buttons {list-style: none; padding: 0;}#id_1624149636224_143.share-buttons li {display: inline;}#id_1624149636224_143.share-buttons .sr-only {position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0; border: 0; height: 1px; width: 1px; overflow: hidden;}</style>
</div></div><div data-silex-type="html-element" class="editable-style silex-id-1563554584898-11 html-element hide-on-mobile bg-shadow" style=""><div class="silex-element-content">

<div id="fb-root"></div>
<script async="" defer="" crossorigin="anonymous" src="https://connect.facebook.net/fr_FR/sdk.js#xfbml=1&amp;version=v7.0&amp;appId=242623139095821" nonce="0Dnd4VdO" type="text/javascript"></script>

<div class="fb-page" data-href="https://www.facebook.com/silexlabs/" data-tabs="timeline" data-width="" data-height="" data-small-header="false" data-adapt-container-width="true" data-hide-cover="false" data-show-facepile="true">
</div></div></div><div data-silex-type="html-element" class="editable-style silex-id-1564088083884-1 html-element hide-on-mobile max-height bg-shadow" style=""><div class="silex-element-content">


<a class="twitter-timeline" href="https://twitter.com/silexlabs?ref_src=twsrc%5Etfw"></a>
<script type="text/javascript" async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</div></div></div></div>
  </section><section data-silex-type="container-element" class="container-element editable-style silex-id-1478366450713-3 section-element prevent-resizable" style="">
      <div data-silex-type="container-element" class="editable-style silex-element-content silex-id-1478366450713-2 container-element website-width bg-shadow" style="">

          <div class="editable-style silex-id-1442914737143-3 text-element style-footer" data-silex-type="text-element" style="">
              <div class="silex-element-content normal"><p><a href="https://www.silex.me/">Powered by Silex</a>, <a href="https://stastic.net/">Stastic</a> <a href="https://jekyllrb.com/">and Jekyll</a><a href="https://pages.github.com/">, </a>hosted on Github pages<a href="https://jekyllrb.com/"><br></a></p><p><a href="https://jekyllrb.com/"></a></p></div>
          </div>
      </div>
  </section><section data-silex-type="container-element" class="prevent-resizable container-element editable-style silex-id-1563544667829-6 section-element"><div data-silex-type="container-element" class="editable-style silex-id-1563544667707-5 container-element silex-element-content website-width"></div></section></body></html>